<div class="dashboard fullviewComponent widget-row learner-track-fullview">
  <div class="widget-heading row">
    <span>
      <i class="fas fa-angle-left" routerLink="/"></i>
    </span>
    <span> How is my organization performing? </span>
  </div>
  <div class="widget-block">

    <div *ngIf="spinner_loader" class="spinner_loading">
      <i class="fas fa-spinner fa-spin fa-3x spinner_inside"></i>
    </div>

    <div *ngIf="!spinner_loader && noDataFlag" class="spinner_loading">
      <span class="spinner_inside">No data found</span>
    </div>

    <div class="m-b-12">
      <div class="float-left form-inline">
        <span>
          <b>Display Leaderboard for </b>
        </span>
        <select class="custom-select w-90 m-l-8" [(ngModel)]="showDetails" (change)="changeData(showDetails)">
          <option [value]="'teams'">Teams</option>
          <option [value]="'trainers'">Trainers</option>
          <option [value]="'learner'">Learners</option>
        </select>
      </div>
      <div class="action-items float-right">
        <span class="compare-selected" (click)="compareSelected()">Add to compare</span>
        <span class="clear-selected">Clear all</span>
      </div>
    </div>
    <div *ngIf="!spinner_loader && !noDataFlag">
      <table class="table table-borderless" *ngIf="showDetails == 'teams'">
        <thead>
          <tr>
            <th scope="col">
              <span *ngIf="!searchBox">
                <span (click)="searchFn()">
                  <i class="fa fa-search" aria-hidden="true"></i>
                </span>
                <span class="text">Team Name</span>
                <span class="m-l-8" (click)="sortByFn('teamName')">
                  <i class="fa fa-sort" aria-hidden="true"></i>
                </span>
              </span>
              <span class="list-inline-item searchList" *ngIf="searchBox">
                <div class="search-org-user">
                  <span class="search-icon" (click)="closeSearchFn()">
                    <i class="fas fa-search"></i>
                  </span>
                  <input type="text" placeholder="Search">
                </div>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('completion')">Completion %
              <span class="m-l-8">
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('completedProgram')">Completed Programs
              <span class="m-l-8">
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('teamsize')">Team Size
              <span class="m-l-8">
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col">Action
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let teamData of responseTeamsDetails | orderBy: sortOrder : reverse">
            <th scope="row" (click)="selectToCompare(teamData.teamName)">
              <span class="m-l-47 check-box" [ngClass]="{'checked-box': compareUsers.includes(teamData.teamName)}"></span>
              <span class="imgActive">
                <img src="/assets/images/user.png" alt="userImg" height="20" width="20">
                <i class="far fa-circle"></i>
              </span>
              <span class="userName">{{teamData.teamName}}</span>
            </th>
            <td class="">{{parseFloat(teamData.completion).toFixed(2)}}</td>
            <td class="">{{teamData.completedProgram}}</td>
            <td class="">{{teamData.teamsize}}</td>
            <td>
              <span *ngIf="teamData.completion > 75" class="action_icon positive-color cursor-pointer" (click)="open(congratsContent)">
                <img src="/assets/IconsSVGs/congradulate.svg" alt="congrats" height="15" width="15"> Congratulate
              </span>
              <span *ngIf="teamData.completion <= 75" class="negative-color cursor-pointer" (click)="open(followUpContent)">
                <i class="fas fa-exclamation-triangle"></i> Follow up
              </span>
            </td>
          </tr>
        </tbody>
      </table>
      <table class="table table-borderless" *ngIf="showDetails == 'trainers'">
        <thead>
          <tr>
            <th scope="col">
              <span *ngIf="!searchBox" (click)="searchFn()">
                <i class="fa fa-search" aria-hidden="true"></i>
              </span>
              <span class="text">Trainer Name</span>
              <span (click)="sortByFn('trainerName')">
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
              <span class="list-inline-item searchList" *ngIf="searchBox">
                <div class="search-org-user">
                  <span class="search-icon" (click)="closeSearchFn()">
                    <i class="fas fa-search"></i>
                  </span>
                  <input type="text" placeholder="Search">
                </div>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('trainingsConducted')">Trainings Conducted
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('peopleTrained')">People Trained
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('avgRating')">Avg. Rating
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let trainerData of responseTrainersDetails | orderBy: sortOrder : reverse ">
            <th scope="row " (click)="selectToCompare(trainerData.trainerName) ">
              <span class="m-l-47 check-box " [ngClass]="{ 'checked-box': compareUsers.includes(trainerData.trainerName)} "></span>
              <span class="imgActive ">
                <img src="/assets/images/user.png " alt="userImg " height="20 " width="20 ">
                <i class="far fa-circle "></i>
              </span>
              <span class="userName ">{{trainerData.trainerName}}</span>
            </th>

            <td class=" ">{{trainerData.trainingsConducted}}</td>
            <td class=" ">{{trainerData.peopleTrained}}</td>
            <td class=" ">
              <span>
                <i class="far fa-star "></i>
              </span>{{trainerData.avgRating}}
            </td>
            <td>
              <span *ngIf="trainerData.avgRating> 3.5" class="action_icon positive-color cursor-pointer" (click)="open(congratsContent)">
                <img src="/assets/IconsSVGs/congradulate.svg" alt="congrats" height="15" width="15"> Congratulate
              </span>
              <span *ngIf="trainerData.avgRating <= 3.5" class="negative-color cursor-pointer" (click)="open(followUpContent)">
                <i class="fas fa-exclamation-triangle"></i> Follow up
              </span>
              <!-- *ngIf="tableData.completion > 75" -->
              <!-- *ngIf="tableData.completion <= 75" -->
            </td>
          </tr>
        </tbody>
      </table>
      <table class="table table-borderless" *ngIf="showDetails == 'learner'">
        <thead>
          <tr>
            <th scope="col">
              <span *ngIf="!searchBox">
                <i class="fa fa-search" aria-hidden="true"></i>
              </span>
              <span class="text">Learner Name</span>
              <span (click)="sortByFn('learnerName')">
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
              <span class="list-inline-item searchList" *ngIf="searchBox">
                <div class="search-org-user">
                  <span class="search-icon" (click)="closeSearchFn()">
                    <i class="fas fa-search"></i>
                  </span>
                  <input type="text" placeholder="Search">
                </div>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('learnerSerialNumber')">
              <span>
                <i class="fa fa-search" aria-hidden="true"></i>
              </span>
              <span class="text">Serial No.</span>
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('pointsEarned')">Points Earned
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('avgTestPerformance')">Avg. Test Performance
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col" (click)="sortByFn('examScore')">Exam Score
              <span>
                <i class="fa fa-sort" aria-hidden="true"></i>
              </span>
            </th>
            <th scope="col">Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let learnerData of responseLeanersDetails| orderBy: sortOrder : reverse">
            <th scope="row " (click)="selectToCompare(learnerData.person_id) ">
              <span class="m-l-47 check-box " [ngClass]="{ 'checked-box': compareUsers.includes(learnerData.person_id)} "></span>
              <span class="imgActive ">
                <img src="/assets/images/user.png " alt="userImg " height="20 " width="20 ">
                <i class="far fa-circle "></i>
              </span>
              <span class="userName ">{{learnerData.learnerName}}</span>
            </th>
            <td class=" ">{{learnerData.learnerSerialNumber}}</td>
            <td class=" ">{{learnerData.pointsEarned}}</td>
            <td class=" ">{{learnerData.avgTestPerformance}}</td>
            <td class=" ">{{learnerData.examScore}}</td>
            <td>
              <!-- *ngIf="tableData.completion> 75" -->
              <span *ngIf="learnerData.examScore > 75" class="action_icon positive-color cursor-pointer" (click)="open(congratsContent)">
                <img src="/assets/IconsSVGs/congradulate.svg" alt="congrats" height="15" width="15"> Congratulate
              </span>
              <span *ngIf="learnerData.examScore <= 75" class="negative-color cursor-pointer" (click)="open(followUpContent)">
                <i class="fas fa-exclamation-triangle"></i> Follow up
              </span>
              <!-- *ngIf="tableData.completion <= 75" -->
            </td>
          </tr>
        </tbody>
      </table>

      <app-paginate class="paginationSpace" [pageInfo]="pagination" (gotoPage)="gotoPage($event)"></app-paginate>

    </div>

  </div>
</div>

<ng-template #followUpContent let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Send an alert</h4>
    <!-- <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button> -->
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="dateOfBirth">Send to</label>
        <div class="input-group">
          <input type="email" class="form-control" placeholder="enter an email">
        </div>
        <br/>
        <label for="dateOfBirth">Message</label>
        <div class="input-group">
          <textarea class="form-control" aria-label="With textarea"></textarea>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" (click)="c('Save click')">Send Alert</button>
    <button type="button" class="btn btn-outline-dark" (click)="c('Save click')">Cancel</button>
  </div>
</ng-template>

<ng-template #congratsContent let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Send a new message</h4>
    <!-- <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
            <span aria-hidden="true">&times;</span>
          </button> -->
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="dateOfBirth">Send to</label>
        <div class="input-group">
          <input type="email" class="form-control" placeholder="enter an email">
        </div>
        <br/>
        <label for="dateOfBirth">Message</label>
        <div class="input-group">
          <textarea class="form-control" aria-label="With textarea"></textarea>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-primary" (click)="c('Save click')">Send Message</button>
    <button type="button" class="btn btn-outline-dark" (click)="c('Save click')">Cancel</button>
  </div>
</ng-template>